@{
    ViewBag.Title = "商家编辑";
}
@using OrderingSystem.Admin.Common;
@model OrderingSystem.Admin.Models.BusinessInfoVM
@section head{
    <style type="text/css">
        .form-group .list-group-item {
            margin: 5px;
        }

            .form-group .list-group-item i {
                float: right;
                color: #FFFFFF;
            }
    </style>
}

<div class="wrapper wrapper-content animated fadeInRight">
    <div class="row">
        <div class="col-sm-12">
            <div class="ibox float-e-margins">
                <div class="ibox-title">
                    <h5>
                        商家编辑 <small>添加、修改</small>
                    </h5>
                </div>
                <div class="ibox-content">
                    <form class="form-horizontal">
                        <input type="hidden" name="bussinessId" id="bussinessId" value="@Model.BusinessInfo.BusinessInfoId">

                        <div class="form-group">
                            <label class="col-sm-2">酒店分类</label>
                            <div class="col-sm-6">
                                <ul class="list-group">
                                    @if (Model.HotelCategoryList != null && Model.HotelCategoryList.Count > 0)
                                    {
                                        foreach (var item in Model.HotelCategoryList)
                                        {
                                            <a class="list-group-item @(Model.HotelRelateCategoryList.Any(p=>p.HotelCategoryId == item.HotelCategoryId) ? "active" :""  )" data-hcid="@item.HotelCategoryId">@item.Name<i class="fa fa-check"></i></a>
                                        }

                                    }
                                </ul>
                            </div>
                        </div>


                        <div class="hr-line-dashed"></div>
                        <div class="form-group">
                            <div class="col-sm-4 col-sm-offset-2">
                                <button id="btnSave" class="btn btn-primary" type="button">保存</button>
                                <a class="btn btn-white" href="javascript:history.go(-1);">取消</a>
                            </div>
                        </div>
                    </form>

                </div>
            </div>
        </div>
    </div>
</div>
@section script{
    <script src="@("/Scripts/plugins/fileinput/fileinput.js"+OrderingSystem.Admin.Versions.Ver)"></script>
    <script src="@("/Scripts/plugins/fileinput/zh.js"+OrderingSystem.Admin.Versions.Ver)"></script> 
    <script type="text/javascript">
        $(function () {

            //配送时间选项点击效果
            var bindClickAnimate = function () {
                $(".list-group a").click(function () {
                    $(this).toggleClass("active")
                });
            }
            bindClickAnimate();

            var bindSaveEvent = function () {
                $("#btnSave").click(function () {

                    var timsSpan = "";
                    $(".list-group-item.active").each(function () {
                        timsSpan += "," + $(this).data("hcid");
                    })
                    var dataArr = { 
                        bussinessId: $("#bussinessId").val(), 
                        Categories: timsSpan
                    };
      
                    window.parent.showModal();
                    //提交
                    $.post('/BusinessInfo/CategorySave', dataArr, function (data) {
                        if (data.Status == 200) {
                            swal("提示", "操作成功");
                            setTimeout(function () {
                                window.location.href = location.href;
                            }, 1500);
                        }
                        if (data.Status == 202) {
                            swal("提示", "操作失败");
                        }
                        if (data.Status == 203) {
                            swal("提示", "数据重复");
                        }
                    }).complete(function () { window.parent.hideModal(); });
                })
            }
            bindSaveEvent();
        });
    </script>
}

